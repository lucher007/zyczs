<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Rp_Stat">
	<typeAlias alias="Rp_Stat" type="cn.gov.zyczs.cspt.po.Rp_Stat" />
	
	<select id="findPlantAreaSumByYear" parameterClass="Rp_Stat" resultClass="Rp_Stat">
		<![CDATA[
			SELECT 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '01', P.PLANTAREA)), 0)) M1, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '02', P.PLANTAREA)), 0)) M2, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '03', P.PLANTAREA)), 0)) M3, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '04', P.PLANTAREA)), 0)) M4, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '05', P.PLANTAREA)), 0)) M5, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '06', P.PLANTAREA)), 0)) M6,
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '07', P.PLANTAREA)), 0)) M7, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '08', P.PLANTAREA)), 0)) M8, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '09', P.PLANTAREA)), 0)) M9, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '10', P.PLANTAREA)), 0)) M10, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '11', P.PLANTAREA)), 0)) M11, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '12', P.PLANTAREA)), 0)) M12 
			FROM ZS_PLANT P WHERE TO_CHAR(P.ADDTIME, 'YYYY') = #year#
		]]>
	</select>
	
	<select id="findPlantAreaSumByYear_NotAdmin" parameterClass="Rp_Stat" resultClass="Rp_Stat">
		<![CDATA[
	 	       SELECT PLANTNAME,
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '01', P.PLANTAREA)),0)  M1, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '02', P.PLANTAREA)),0) M2, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '03', P.PLANTAREA)),0) M3, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '04',  P.PLANTAREA)),0) M4, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '05',  P.PLANTAREA)),0) M5, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '06',  P.PLANTAREA)),0) M6, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '07',  P.PLANTAREA)),0) M7, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '08',  P.PLANTAREA)),0) M8, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '09',  P.PLANTAREA)),0) M9, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '10',  P.PLANTAREA)),0) M10, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '11',  P.PLANTAREA)),0) M11, 
		       NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '12',  P.PLANTAREA)),0) M12 
			   FROM ZS_PLANT P
			   WHERE TO_CHAR(P.ADDTIME, 'YYYY') = #year#
		]]>
		<dynamic prepend="and">
		  <isNotEmpty property="plantname">
		  	<![CDATA[
		  		 PLANTNAME IN('$plantname$')
		  	]]>
		  </isNotEmpty>
		</dynamic>
		<![CDATA[
			 GROUP BY PLANTNAME
		]]>
	</select>
	
	<select id="findSellWeightByYear" parameterClass="Rp_Stat" resultClass="Rp_Stat">
		<![CDATA[
			   SELECT 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '01', IOS.TOTALWEIGHT/10000000)),0)  M1, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '02', IOS.TOTALWEIGHT/10000000)),0) M2, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '03', IOS.TOTALWEIGHT/10000000)),0) M3, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '04',  IOS.TOTALWEIGHT/10000000)),0) M4, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '05',  IOS.TOTALWEIGHT/10000000)),0) M5, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '06',  IOS.TOTALWEIGHT/10000000)),0) M6, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '07',  IOS.TOTALWEIGHT/10000000)),0) M7, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '08',  IOS.TOTALWEIGHT/10000000)),0) M8, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '09',  IOS.TOTALWEIGHT/10000000)),0) M9, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '10',  IOS.TOTALWEIGHT/10000000)),0) M10, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '11',  IOS.TOTALWEIGHT/10000000)),0) M11, 
		       NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '12',  IOS.TOTALWEIGHT/10000000)),0) M12 
			   FROM ZS_INOUTSTOR IOS
			   WHERE IOS.TYPE=0 AND IOS.STORTYPE=1 AND TO_CHAR(IOS.OPERSYSTIME, 'YYYY') = #year#
		]]>
	</select>
	
	
	<select id="findMedRateByYear" parameterClass="Rp_Stat" resultClass="Rp_Stat">
		<![CDATA[
			SELECT 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '01', P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2)  M1, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '02', P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M2, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '03', P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M3, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '04',  P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M4, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '05',  P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M5, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '06',  P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M6, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '07',  P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M7, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '08',  P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M8, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '09',  P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M9, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '10',  P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M10, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '11',  P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M11, 
			ROUND(NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'MM'), '12',  P.PLANTAREA)),0)/ NVL(SUM(DECODE(TO_CHAR(P.ADDTIME, 'YYYY'), #year#, P.PLANTAREA)),0),2) M12 
			FROM ZS_PLANT P
			WHERE TO_CHAR(P.ADDTIME, 'YYYY') =#year#
		]]>
	</select>
	
	
	<select id="findSellWeightByYear_NotAdmin" parameterClass="Rp_Stat" resultClass="Rp_Stat">
		<![CDATA[
	 	      	SELECT IOSB.PRODNAME plantname,
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '01', IOS.TOTALWEIGHT/10000000)),0)  M1, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '02', IOS.TOTALWEIGHT/10000000)),0) M2, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '03', IOS.TOTALWEIGHT/10000000)),0) M3, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '04',  IOS.TOTALWEIGHT/10000000)),0) M4, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '05',  IOS.TOTALWEIGHT/10000000)),0) M5, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '06',  IOS.TOTALWEIGHT/10000000)),0) M6, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '07',  IOS.TOTALWEIGHT/10000000)),0) M7, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '08',  IOS.TOTALWEIGHT/10000000)),0) M8, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '09',  IOS.TOTALWEIGHT/10000000)),0) M9, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '10',  IOS.TOTALWEIGHT/10000000)),0) M10, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '11',  IOS.TOTALWEIGHT/10000000)),0) M11, 
				NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '12',  IOS.TOTALWEIGHT/10000000)),0) M12 
				FROM ZS_INOUTSTOR IOS
				INNER JOIN 
				ZS_INOUTSTORBOX IOSB
				ON IOS.INOUTSTORID = IOSB.INOUTSTORID
				WHERE IOS.TYPE=0 AND IOS.STORTYPE=1 AND TO_CHAR(IOS.OPERSYSTIME, 'YYYY') = #year#
		]]>
		<dynamic prepend="and">
		  <isNotEmpty property="plantname">
		  	<![CDATA[
		  		 PRODNAME IN('$plantname$')
		  	]]>
		  </isNotEmpty>
		</dynamic>
		<![CDATA[
			GROUP BY IOSB.PRODNAME
		]]>
	</select>

	
	<select id="findTabletProAndSellByYear" parameterClass="Rp_Stat" resultClass="Rp_Stat">
		<![CDATA[
			SELECT 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '01', S.TABLETWEIGHT/10000000)),0)  M1, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '02', S.TABLETWEIGHT/10000000)),0) M2, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '03', S.TABLETWEIGHT/10000000)),0) M3, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '04',  S.TABLETWEIGHT/10000000)),0) M4, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '05',  S.TABLETWEIGHT/10000000)),0) M5, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '06',  S.TABLETWEIGHT/10000000)),0) M6, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '07',  S.TABLETWEIGHT/10000000)),0) M7, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '08',  S.TABLETWEIGHT/10000000)),0) M8, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '09',  S.TABLETWEIGHT/10000000)),0) M9, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '10',  S.TABLETWEIGHT/10000000)),0) M10, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '11',  S.TABLETWEIGHT/10000000)),0) M11, 
			NVL(SUM(DECODE(TO_CHAR(S.ADDTIME, 'MM'), '12',  S.TABLETWEIGHT/10000000)),0) M12 
			FROM ZS_TABLETSTORAGE S
			WHERE S.TABLETNUMWEIGHT IS NULL AND S.TABLETNUM IS NULL AND TO_CHAR(S.ADDTIME, 'YYYY') = #year#
			UNION ALL
			SELECT 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '01', IOS.TOTALWEIGHT/10000000)),0)  M1, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '02', IOS.TOTALWEIGHT/10000000)),0) M2, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '03', IOS.TOTALWEIGHT/10000000)),0) M3, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '04',  IOS.TOTALWEIGHT/10000000)),0) M4, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '05',  IOS.TOTALWEIGHT/10000000)),0) M5, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '06',  IOS.TOTALWEIGHT/10000000)),0) M6, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '07',  IOS.TOTALWEIGHT/10000000)),0) M7, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '08',  IOS.TOTALWEIGHT/10000000)),0) M8, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '09',  IOS.TOTALWEIGHT/10000000)),0) M9, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '10',  IOS.TOTALWEIGHT/10000000)),0) M10, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '11',  IOS.TOTALWEIGHT/10000000)),0) M11, 
			NVL(SUM(DECODE(TO_CHAR(IOS.OPERSYSTIME, 'MM'), '12',  IOS.TOTALWEIGHT/10000000)),0) M12 
			FROM ZS_INOUTSTOR IOS
			WHERE IOS.TYPE=1 AND IOS.STORTYPE=1 AND TO_CHAR(IOS.OPERSYSTIME, 'YYYY') = #year#
		]]>
	</select>
	
</sqlMap>